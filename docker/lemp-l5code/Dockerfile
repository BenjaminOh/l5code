FROM appkr/lemp-base:latest

#-------------------------------------------------------------------------------
# 환경변수를 설정합니다.
#-------------------------------------------------------------------------------

ENV DEBIAN_FRONTEND=noninteractive

#-------------------------------------------------------------------------------
# 설정을 Docker 이미지로 복사합니다.
#-------------------------------------------------------------------------------

COPY files /

#-------------------------------------------------------------------------------
# Ngix를 설정합니다.
#-------------------------------------------------------------------------------

RUN rm /etc/nginx/sites-available/default \
    && rm /etc/nginx/sites-enabled/default \
    && ln -nfs /etc/nginx/sites-available/myapp.conf /etc/nginx/sites-enabled/

#-------------------------------------------------------------------------------
# 작업 디렉터리를 설정하고, 마운트할 수 있는 볼륨 및 포트를 노출합니다.
#-------------------------------------------------------------------------------

WORKDIR /var/www/myapp
VOLUME ["/var/www/myapp", "/var/lib/mysql"]
EXPOSE 80 9991 3306
